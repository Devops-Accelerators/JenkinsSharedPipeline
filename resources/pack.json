{
"variables": {
        "aws_access_key": "{{env `AWS_ACCESS_KEY_ID`}}",
          "aws_secret_key": "{{env `AWS_SECRET_ACCESS_KEY`}}",
        "sshpassword":"{{env `packer_pass`}}",
        "region": "eu-west-1"
    },
    "builders": [
        {
            "ami_name": "sas@123_{{timestamp}}",
            "access_key": "{{user `aws_access_key`}}",
            "secret_key": "{{user `aws_secret_key`}}",
           
            "instance_type": "t2.micro",
            "region": "eu-west-1",
            "source_ami": "ami-bbc542c8",
             "ssh_username": "ubuntu",
            "type": "amazon-ebs",
            "communicator": "ssh",
            "ssh_password":"{{user `sshpassword`}}"
        }
    ],
    "provisioners": [
         {
           "type": "file",
            "source": "/var/lib/jenkins/workspace/sas2/resources/example.sh",
            "destination": "/home/ubuntu/example.sh"

        },
        {
            "type": "shell",
            "scripts": ["/var/lib/jenkins/workspace/sas2/resources/example.sh"]
        },
             {
           "type": "file",
            "source": "/var/lib/jenkins/workspace/sas2/resources/docker.sh",
            "destination": "/home/ubuntu/docker.sh"

        },
        {
            "type": "shell",
            "scripts": ["/var/lib/jenkins/workspace/sas2/resources/docker.sh"]
        },
          {
           "type": "file",
            "source": "/var/lib/jenkins/workspace/sas2/resources/Dockerfile",
            "destination": "/home/ubuntu/Dockerfile"

        },
        {
            "type": "shell",
            "inline": ["sudo docker build /var/lib/jenkins/workspace/sas2/resources/",
                      "docker images"]
        },
            {
           "type": "file",
            "source": "/var/lib/jenkins/workspace/sas2/resources/tomcat-users.xml",
            "destination": "/home/ubuntu/tomcat-users.xml"

        },
            {
           "type": "file",
            "source": "/var/lib/jenkins/workspace/sas2/resources/context.xml",
            "destination": "/home/ubuntu/context.xml"

        }
    ]
}
